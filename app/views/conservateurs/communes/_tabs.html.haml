-# locals: :current_tab, :dossier, :commune

- current_tab_title = conservateur_commune_tabs(commune).find { _1.key == current_tab }.title
- content_for(:head_title) { "#{current_tab_title} - #{commune}" }
- departement = commune.departement

%main.fr-container.fr-pb-8w
  = render "shared/breadcrumbs",
    links: [["DÃ©partements", conservateurs_departements_path],
      [commune.departement.nom, conservateurs_departement_path(departement)],
      [commune.to_s, conservateurs_commune_path(commune)]],
    current_page_label: current_tab_title

  %div{class: ("co-print-hide" if local_assigns[:hide_for_print])}
    .co-flex.co-flex--align-items-center.co-flex--gap-1rem.fr-mb-1w
      %h1= commune
      - if commune.inactive?
        .co-flex--shrink-0
          .fr-badge Commune inactive
      - if local_assigns[:dossier]
        .co-flex--shrink-0
          %div= dossier_status_badge dossier

  = turbo_frame_tag "commune-tabs", autoscroll: true, data: { autoscroll_block: "start" } do
    = dsfr_tabs classes: (local_assigns[:no_padding] ? ["co-tabs--no-padding"] : []) do |tabs|
      - conservateur_commune_tabs(commune).each do |commune_tab|
        - if commune_tab.key == current_tab
          = tabs.with_tab(title: commune_tab.title, active: true, path: commune_tab.path).with_content(yield)
        - else
          = tabs.with_tab title: commune_tab.title, path: commune_tab.path
