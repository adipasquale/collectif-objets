-# locals: (:wizard)

= render "communes/recensements/wizard_form", wizard: wizard do |form_builder|

  = render "communes/recensements/fields/localisation", form_builder:

  = render "communes/recensements/fields/recensable", form_builder:

  = form_builder.hidden_field :confirmation_not_recensable

  - if @modal == "confirmation-not-recensable"
    = dsfr_modal(title: "Je confirme que l’objet n’est pas recensable",
        html_attributes: { id: "modal-confirmation-not-recensable",
          "data-controller": "modal-auto-open",
          "data-modal-auto-open-target": "modal"}) do |m|
      %p Cette option est à utiliser dans le cas où vous n’avez pas accès à l’objet, par exemple dans un clocher dangereusement accessible, ou bien un objet qui se trouve temporairement en restauration.
      %p Vous allez être redirigé directement vers l’étape des commentaires.
      %p
        Vous pouvez aussi contacter votre conservateur via la
        = link_to "messagerie", commune_messages_path(wizard.commune)
        pour lui demander de l’aide ou des conseils pour recenser l’objet.

      - m.with_button label: "Confirmer et continuer", html_attributes: { type: "submit" }
      - m.with_button label: "Annuler",
          level: :secondary,
          html_attributes: { type: "button",
            "aria-controls": "modal-confirmation-not-recensable",
            "data-controller": "button-link",
            "data-action": "button-link#handleClick",
            "data-href": edit_commune_objet_recensement_path(wizard.commune, wizard.objet, wizard.recensement, step: 2) }

  .co-text--right
    = form_builder.submit "Passer à l’étape suivante", class: "fr-btn"
    .fr-mt-2w= render "communes/recensements/previous_step_link", wizard:
